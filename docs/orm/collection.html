<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>
        Lazy Framework - Orm - Collection    </title>
    <link href="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
    <link href="/lazy/assets/vendor/codemirror/4.1/lib/codemirror.css" rel="stylesheet">
    <link href="/lazy/assets/vendor/codemirror/4.1/theme/mdn-like.css" rel="stylesheet">
    <link href="/lazy/assets/stylesheets/application.css?__dc" rel="stylesheet">    </head>
<body>
<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/lazy/index.html">Lazy Framework</a>
        </div>
        <div class="collapse navbar-collapse">
            <ul class="nav navbar-nav navbar-right">
                <li><a href="/lazy/docs/installation.html">Documentation</a></li>
            </ul>
        </div><!--/.nav-collapse -->
    </div>
</div>

<div class="container">
    <div class="row">
        <div class="col-md-3">
            <br>
            <br>
            <ul class="nav">
                <li>
                    <a href="#"><b>Getting Started</b></a>
                    <ul>
                        <li><a href="/lazy/docs/installation.html">Installation</a></li>
                        <li><a href="/lazy/docs/system-requirements.html">System Requirements</a></li>
                    </ul>
                </li>
                <li>
                    <a href="#"><b>Application</b></a>
                    <ul>
                        <li><a href="/lazy/docs/application-structure.html">Application Structure</a></li>
                        <li><a href="/lazy/docs/server-configuration.html">Server Configuration</a></li>
                        <li><a href="#">Request</a></li>
                        <li><a href="/lazy/docs/routing.html">Routing</a></li>
                        <li><a href="#">View</a></li>
                        <li><a href="#">Response</a></li>
                    </ul>
                </li>
                <li>
                    <a href="#"><b>Database</b></a>
                    <ul>
                        <li><a href="/lazy/docs/databases/connection.html">Connection</a></li>
                        <li><a href="/lazy/docs/databases/query-builder.html">Query Builder</a></li>
                    </ul>
                </li>
                <li>
                    <a href="/lazy/docs/orm/define-model.html"><b>ORM</b></a>
                    <ul>
                        <li><a href="/lazy/docs/orm/define-model.html">Defining Models</a></li>
                        <li>
                            <a href="/lazy/docs/orm/model-overview.html">Model Interaction</a>
                            <ul>
                                <li><a href="/lazy/docs/orm/model-overview.html">Overview</a></li>
                                <li><a href="/lazy/docs/orm/model.html">Model</a></li>
                                <li><a href="/lazy/docs/orm/collection.html">Collection</a></li>
                            </ul>
                        </li>
                        <li>
                            <a href="/lazy/docs/orm/relationship-overview.html">Relationship</a>
                            <ul>
                                <li><a href="/lazy/docs/orm/relationship-overview.html">Overview</a></li>
                                <li><a href="/lazy/docs/orm/relationship-has-one.html">Has One</a></li>
                                <li><a href="/lazy/docs/orm/relationship-has-many.html">Has Many</a></li>
                                <li><a href="/lazy/docs/orm/relationship-belongs-to.html">Belongs To</a></li>
                                <li><a href="/lazy/docs/orm/relationship-has-many-through.html">Has Many Through</a></li>
                            </ul>
                        </li>

                    </ul>
                </li>
                <li>
                    <a href="#"><b>Development Tools</b></a>
                    <ul>
                        <li><a href="#">Console</a></li>
                        <li><a href="#">Model Generator</a></li>
                    </ul>
                </li>
            </ul>
        </div>
        <div class="col-md-9">
            <div class="page-header">
    <h1>Model Collection</h1>
</div>

<h4>Retrieving Multiple Records <em class="text-muted">AKA Collection</em></h4>
<textarea class="code">
    $users = User::all();
</textarea>

<h4>Retrieving Multiple Records By Primary Key List</h4>
<textarea class="code">
    $users = User::all([1, 2, 3]);
</textarea>

<h4>Retrieving Multiple Records By Conditions</h4>
<textarea class="code">
    $users = User::all(['status = ?' => 1]);
    // or
    $users = User::all()->where('status = ?', 1);
</textarea>

<br>
<div class="alert alert-info">
    Almost all sql Select method is visible in Collection:
    <code>select</code>,
    <code>distinct</code>,
    <code>calcFoundRows</code>,
    <code>where</code>,
    <code>orWhere</code>,
    <code>having</code>,
    <code>orHaving</code>,
    <code>orderBy</code>,
    <code>groupBy</code>,
    <code>limit</code>,
    <code>offset</code>,
    <code>join</code>,
    <code>leftJoin</code>,
    <code>rightJoin</code>,
</div>

<div class="alert alert-info">
    Sql querying in Collection is <b><em>Lazy</em></b>,
    it mean there are no query is executed until you interacting with the collection data.
    So you could adding more query filter to the collection later.
<textarea class="code">
    $users = User::all(); // no sql query executing here
    $users->where('status = ?', 1); // no sql query executing here too
    $users->toArray(); // That is! The query executed is: SELECT users.* FROM users WHERE (status = 1)
</textarea>
</div>

<div class="alert alert-info">
    The Model Collection class is implemented of
    <code>Countable</code>,
    <code>IteratorAggregate</code>,
    <code>JsonSerializable</code>, <code>ArrayAccess</code>.
    So you could counting, iterate, encode as json or interacting it as array style.
<textarea class="code">
    $users = User::all();

    // Counting
    count($users);

    // json encoding
    json_encode($users);

    // iterate
    foreach ($users as $user) {
        echo $user->name;
    }

    // interacting as array
    $user = $users[0];
</textarea>
</div>

<p>Collection have 2 fallback method to model: <code>save</code> and <code>delete</code> and the model property setter.</p>
<textarea class="code">
    $users = User::all();

    // mass update models
    $users->status = 'active';
    $users->save();

    // mass delete models
    $users->delete();
</textarea>

<h4>Lazy Loading</h4>
<p>
    Lazy Model support <b>Lazy Loading</b>. By default, the column types below considering as <b>Lazy Loading</b>:
<ul>
    <li><code>Model::TEXT (text)</code>
    <li><code>Model::MEDIUMTEXT (mediumtext)</code>
    <li><code>Model::LONGTEXT (longtext)</code>
    <li><code>Model::BLOB (blob)</code>
    <li><code>Model::MEDIUMBLOB (mediumblob)</code>
    <li><code>Model::LONGBLOB (longblob)</code>
</ul>
Feel free to custom you own lazy loading column by defining property
<code>$defaultLazyLoadColumnTypes</code> or <code>$defaultSelectColumns</code> in your model definition.
</p>

<textarea class="code">
    $posts = Posts::all([1, 2, 3]);

    foreach ($posts as $post) {
        echo $post->title;
    }

    /*
        The query executed is:
        SELECT posts.id, posts.creator_id, posts.title, posts.created_time, posts.modified_time
        FROM posts
        WHERE (id IN(1, 2, 3))
    */
</textarea>

<p>
    As you see. The column <code>content</code> of posts table not selected yet. But when the first time you get the content property,
    it will select the <code>content</code> column related to the collection.
</p>
<textarea class="code">
    foreach ($posts as $post) {
        echo $post->content;
    }

    /*
        The second query executed is:
        SELECT posts.id, posts.content FROM posts WHERE (id IN(1, 2, 3))
    */
</textarea>

<h4 id="eager-loading">Eager Loading</h4>
<p>
    The <b>Eager Loading</b> existing to resolve the <code>N + 1</code> query problem.
    For example, in the <a href="/docs/databases/define-model">Defining Models</a>,
    the <code>Post</code> model related to <code>User</code> model specified by <code>Creator</code>.
    See an example above, we retrieving the creator name of post collection:
</p>.

<textarea class="code">
    $posts = Posts::all();

    foreach ($posts as $post) {
        echo $post->Creator->name;
    }
</textarea>

<p>
    Assume the posts table have <code>100</code> records.<br>
    Normally, you are guessing there are total <code>101</code> queries executed.
    <code>1</code> is for the posts list, and <code>100</code> queries for each post to retrieving the creator name.<br>
    Actually, there are just <code>2</code> queries executed:
</p>
<textarea class="code" data-type="sql">
    SELECT id, creator_id, title, created_time, modified_time FROM posts;
    SELECT id, name WHERE (id IN(/* the creator_id FROM post list*/))
</textarea>
<br>

<div class="alert alert-info">
    Unlike some ORM libraries, they implemented <b>Eager Loading</b> by style look like this:
<textarea class="code">
    $posts = Post::with('Creator');

    foreach ($posts as $post) {
        echo $post->Creator->name;
    }
</textarea>
    <b>Lazy ORM</b> do this automatically. No need to call something like <code>with('Creator')</code>
</div>        </div>
    </div>
</div>

<br>

<div class="container">
    <div class="row">
        <div class="col-md-9 col-md-offset-3">
            <hr>
            <div id="disqus_thread"></div>
            <script type="text/javascript">
                /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
                var disqus_shortname = 'lazy-framework'; // required: replace example with your forum shortname

                /* * * DON'T EDIT BELOW THIS LINE * * */
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            </script>
            <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
            <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        </div>
    </div>
</div>

<hr>

<footer>
    <div class="container">
        <div>
            <div class="pull-left">
                <iframe src="http://ghbtns.com/github-btn.html?user=lazy-framework&repo=lazy&type=watch&count=true"
                        allowtransparency="true" frameborder="0" scrolling="0" width="100" height="20"></iframe>
                <iframe src="http://ghbtns.com/github-btn.html?user=lazy-framework&repo=lazy&type=fork&count=true"
                        allowtransparency="true" frameborder="0" scrolling="0" width="100" height="20"></iframe>
                <iframe src="http://ghbtns.com/github-btn.html?user=lazy-framework&repo=lazy&type=follow&count=true"
                        allowtransparency="true" frameborder="0" scrolling="0" width="180" height="20"></iframe>
            </div>
        </div>
        <div class="pull-right">
            <ul class="list-inline">
                <li><a href="https://github.com/lazy-framework/lazy">GitHub</a></li>
                <li><a href="/lazy/docs/installation.html">Documentation</a></li>
            </ul>
        </div>
    </div>
</footer>
<br>
<br>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script src="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>

<script src="/lazy/assets/vendor/codemirror/4.1/lib/codemirror.js"></script>
<script src="/lazy/assets/vendor/codemirror/4.1/lib/util/formatting.js"></script>
<script src="/lazy/assets/vendor/codemirror/4.1/addon/edit/matchbrackets.js"></script>
<script src="/lazy/assets/vendor/codemirror/4.1/mode/htmlmixed/htmlmixed.js"></script>
<script src="/lazy/assets/vendor/codemirror/4.1/mode/javascript/javascript.js"></script>
<script src="/lazy/assets/vendor/codemirror/4.1/mode/css/css.js"></script>
<script src="/lazy/assets/vendor/codemirror/4.1/mode/clike/clike.js"></script>
<script src="/lazy/assets/vendor/codemirror/4.1/mode/php/php.js"></script>
<script src="/lazy/assets/vendor/codemirror/4.1/mode/nginx/nginx.js"></script>
<script src="/lazy/assets/vendor/codemirror/4.1/mode/sql/sql.js"></script>
<script src="/lazy/assets/javascripts/application.js?__dc"></script><script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-50648420-1', 'lazy-framework.github.io');
    ga('send', 'pageview');

</script>
</body>
</html>